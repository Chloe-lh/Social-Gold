{% extends "base.html" %}

{% load static %}
{% block head %}
<link rel="stylesheet">
<style>
/* Responsive search bar */
.search-bar {
    width: 100%;
    max-width: 100%;
    padding: 12px 20px;
    font-size: 1rem;
    box-sizing: border-box;
    margin-bottom: 20px;
}

/* Clickable rows */
.author-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px;
    margin-bottom: 8px;
    border: 1px solid #ddd;
    border-radius: 5px;
    transition: background-color 0.2s;
    cursor: pointer;
}

.author-row:hover {
    background-color: #f0f0f0;
}

.follow-btn {
    padding: 6px 12px;
    background-color: gold;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
}

.follow-btn:hover {
    background-color: darkgoldenrod;
}
</style>
{% endblock %}

{% block content %}
<section class="search-section">
    <header>
        <h2>Search Authors</h2>
    </header>

    <form method="GET" action="{% url 'search_authors' %}" style="display: flex; width: 100%; gap: 10px; margin-bottom: 20px; height: 48px;">
        <input type="text" name="q" class="search-bar" placeholder="Search by username" value="{{ query }}" 
            style="flex: 1; padding: 0 20px; font-size: 1rem; box-sizing: border-box; height: 100%;">
        <button type="submit" 
                style="flex-shrink: 0; padding: 0 20px; font-size: 1rem;  border: 2px solid #000; background: #E7B393; border-radius: 4px; cursor: pointer; height: 100%;">
            Search
        </button>
    </form>

    <div class="author-list">
        {% if authors %}
            <ul style="list-style: none; padding: 0; ">
                {% for author in authors %}
                    <li class="author-row">
                        <span>
                            {{ author.username }}
                        </span>
                        <button class="follow-btn" onclick="btnFunctionality(this)" style="border: 2px solid #000; background: #E7B393;">
                            {% if page_type == 'followers' %}
                                Unfollow
                            {% elif page_type == 'following' %}
                                Remove
                            {% else %}
                                Follow
                            {% endif %}
                        </button>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No authors found.</p>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    window.btnFunctinality = function(button) {
        if(button.textContent === 'Follow'){
            button.textContent = "Requested";
            button.disabled = true;
            button.style.border = "2px solid gray";
        } else if(button.textContent === 'Unfollow'){
            button.textContent = "Unfollowed";
            button.disabled = true;
            button.style.border = "2px solid gray";
        } else if(button.textContent === 'Remove'){
            button.textContent = "Removed";
            button.disabled = true;
            button.style.border = "2px solid gray";
        }       
    };
});
</script>
{% endblock %}